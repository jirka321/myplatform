<!doctype html>
<html lang="cs">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}MyPria{% endblock %}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    {% block head_extra %}{% endblock %}
    <style>
        :root {
            --text: #0f1a24;
            --muted: #4b6b88;
            --border: rgba(0, 0, 0, .10);
            --ink: #0a0a0a;
            --glass: #ffffffcc;
            --glass-soft: #ffffff80;
            --accent-a: #7EC8FF;
            --accent-b: #B8E1FF;
            --brand-blue: #3390CC;
            --brand-purple: #7A5FCC;
            --brand-pink: #C65C8C;
            --bg: #FAF9F7;
            --content-px: 8px;
            --inner-hdr-h: 56px;
            --site-h: 56px;
            --container: 1130px;
            --site-pad-x: 20px;
            --logo-bleed-desktop: -50px;
            --orb-box: 44px;
            --orb-core: 38px;
            --orb-ring: 58px;
        }

        html,
        body {
            height: 100%;
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        html,
        body {
            overscroll-behavior-x: none;
            overflow-x: clip;
        }

        @supports not (overflow: clip) {

            html,
            body {
                overflow-x: hidden;
            }
        }

        html {
            scroll-behavior: auto;
        }

        html {
            scroll-padding-top: calc(var(--site-h) + 20px);
            scroll-padding-bottom: 140px;
        }

        body {
            margin: 0;
            background: var(--bg);
            color: var(--text);
            font-family: "Poppins", ui-sans-serif, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Ubuntu, Cantarell;
            overflow-x: hidden;
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
        }

        /* Background blobs/orb */
        .bg {
            position: fixed;
            inset: -20vh -20vw -20vh -20vw;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .bg::before {
            content: "";
            position: absolute;
            width: 82vmin;
            height: 82vmin;
            left: 50%;
            top: 46%;
            transform: translate(-50%, -50%);
            background: radial-gradient(circle at 50% 50%, rgba(0, 185, 255, .44) 0%, rgba(92, 122, 255, .40) 33%, rgba(255, 120, 200, .30) 58%, rgba(0, 0, 0, 0) 72%);
            filter: blur(120px);
            opacity: .92;
        }

        .bg::after {
            content: "";
            position: absolute;
            width: 48vmin;
            height: 48vmin;
            left: 50%;
            top: 46%;
            transform: translate(-50%, -50%);
            background: radial-gradient(circle at 50% 50%, rgba(255, 255, 255, .80) 0%, rgba(255, 255, 255, 0) 60%);
            filter: blur(30px);
            opacity: .9;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: .95;
                filter: blur(90px)
            }

            50% {
                transform: scale(1.15);
                opacity: .85;
                filter: blur(120px)
            }

            100% {
                transform: scale(1);
                opacity: .95;
                filter: blur(90px)
            }
        }

        @keyframes drift {
            0% {
                transform: translate3d(-2vw, -2vh, 0) scale(1)
            }

            50% {
                transform: translate3d(2vw, 1vh, 0) scale(1.08)
            }

            100% {
                transform: translate3d(-2vw, -2vh, 0) scale(1)
            }
        }

        .blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(110px);
            transform: translateZ(0);
            opacity: .18;
        }

        .blob.r1 {
            width: 64vmin;
            height: 64vmin;
            left: calc(50% - 44vmin);
            top: calc(50% - 18vmin);
            background: radial-gradient(circle at 50% 50%, rgba(255, 80, 80, .55) 0%, rgba(255, 80, 80, .22) 45%, rgba(255, 80, 80, 0) 72%);
            animation: drift 14s ease-in-out infinite;
        }

        .blob.r2 {
            width: 50vmin;
            height: 50vmin;
            left: calc(50% + 24vmin);
            top: calc(50% - 26vmin);
            background: radial-gradient(circle at 50% 50%, rgba(255, 120, 120, .50) 0%, rgba(255, 120, 120, .20) 45%, rgba(255, 120, 120, 0) 72%);
            animation: pulse 10s ease-in-out infinite;
        }

        .blob.y1 {
            width: 70vmin;
            height: 70vmin;
            left: calc(50% - 28vmin);
            top: calc(50% + 24vmin);
            background: radial-gradient(circle at 50% 50%, rgba(255, 210, 0, .54) 0%, rgba(255, 210, 0, .20) 45%, rgba(255, 210, 0, 0) 72%);
            animation: drift 16s ease-in-out infinite;
        }

        .blob.y2 {
            width: 48vmin;
            height: 48vmin;
            left: calc(50% + 22vmin);
            top: calc(50% + 10vmin);
            background: radial-gradient(circle at 50% 50%, rgba(255, 180, 0, .52) 0%, rgba(255, 180, 0, .20) 45%, rgba(255, 180, 0, 0) 72%);
            animation: pulse 12s ease-in-out infinite;
        }

        .blob.y3 {
            width: 40vmin;
            height: 40vmin;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            background: radial-gradient(circle at 50% 50%, rgba(255, 230, 90, .50) 0%, rgba(255, 230, 90, .18) 45%, rgba(255, 230, 90, 0) 72%);
            animation: drift 11s ease-in-out infinite;
        }

        /* Layout (mobile-first) */
        .wrap {
            position: relative;
            z-index: 1;
            min-height: calc(100dvh - var(--site-h));
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
        }

        .glass {
            width: min(1180px, 100%);
            border-radius: 20px;
            background: transparent;
            border: none;
            box-shadow: none;
            backdrop-filter: none;
            -webkit-backdrop-filter: none;
        }


        /* Profile + logo */
        .site-header {
            position: relative;
            width: 100%;
            max-width: var(--container);
            margin: 0 auto;
            padding: 12px var(--site-pad-x) 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
            background: transparent;
            border: none;
            box-shadow: none;
        }

        .site-logo {
            position: static;
            top: auto;
            left: auto;
            z-index: auto;
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
        }

        .mini-orb {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: conic-gradient(from 0turn at 50% 50%, var(--brand-blue), var(--brand-purple), var(--brand-pink), var(--brand-blue)), radial-gradient(60% 60% at 45% 40%, rgba(255, 255, 255, .28), rgba(255, 255, 255, 0) 60%);
            box-shadow: 0 0 10px rgba(139, 92, 246, .35), inset 0 0 0 1px rgba(255, 255, 255, .35);
            animation: sweep 7.5s linear infinite;
        }

        @keyframes sweep {
            0% {
                background-position: 0 0;
            }

            100% {
                background-position: 360deg 0;
            }
        }

        @media (min-width: 1181px) {
            .mini-orb {
                width: 38px;
                height: 38px;
            }
        }

        .site-logo .site-title {
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            letter-spacing: .5px;
            font-size: 1.0rem;
            color: #0f1a24;
        }

        @media (min-width: 900px) {
            .site-logo .site-title {
                font-size: 1.0rem;
            }
        }

        .profile {
            position: static;
            top: auto;
            right: auto;
            z-index: auto;
        }

        .profile-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fff;
            border: 1px solid rgba(15, 27, 36, .12);
            cursor: pointer;
            transition: background .2s ease, border .2s ease, box-shadow .2s ease;
            box-shadow: 0 4px 12px rgba(15, 27, 36, .08);
        }

        .profile-btn:hover {
            box-shadow: 0 6px 16px rgba(0, 140, 255, .12);
            border-color: rgba(0, 140, 255, .25);
        }

        .menu {
            position: absolute;
            right: 0;
            top: 44px;
            width: 220px;
            border: 1px solid rgba(15, 27, 36, .12);
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 12px 24px rgba(15, 27, 36, .16);
            padding: 8px;
            display: none;
        }

        .menu.open {
            display: block;
        }

        .menu h4 {
            margin: 4px 8px 8px;
            font-family: 'Poppins', sans-serif;
            font-size: 12px;
            letter-spacing: .3px;
            color: #274156;
        }

        .menu .item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            border-radius: 10px;
            background: none;
            border: 1px solid transparent;
            cursor: pointer;
            width: 100%;
            color: var(--text);
            text-decoration: none;
            font-family: inherit;
            font-size: 14px;
        }

        .menu .item:hover {
            background: rgba(0, 140, 255, .05);
            border-color: rgba(0, 140, 255, .12);
        }

        .sep {
            height: 1px;
            background: linear-gradient(90deg, rgba(15, 27, 36, .06), rgba(15, 27, 36, .12), rgba(15, 27, 36, .06));
            margin: 6px;
        }

        /* Desktop styles */
        @media (min-width: 900px) {
            :root {
                --content-px: 26px;
            }

            .site-header {
                padding: 20px var(--site-pad-x) 0;
            }
        }

        @media (min-width: 1181px) {
            .site-header .site-logo {
                margin-left: var(--logo-bleed-desktop);
                margin-top: 5px;
            }
        }

        /* Content area styling */
        .content {
            max-width: 800px;
            margin: 0 auto;
        }

        p {
            line-height: 1.6;
            margin-bottom: 1em;
        }

        .text-center {
            text-align: center;
        }

        .mt-4 {
            margin-top: 2rem;
        }

        .mb-4 {
            margin-bottom: 2rem;
        }
    </style>
    {% block head_css %}{% endblock %}
</head>

<body>
    <header class="site-header">
        <a class="site-logo" href="/" aria-label="MyPria">
            <span class="mini-orb" aria-hidden="true"></span>
            <span class="site-title">MyPria</span>
        </a>

        {% block header_actions %}
        {% if show_home %}
        <div class="profile">
            <a href="/" class="home-btn"
                style="display:flex;align-items:center;gap:6px;color:#000;font-size:14px;text-decoration:none;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="22" height="22" fill="currentColor">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" />
                </svg>
                Home
            </a>
        </div>
        {% endif %}
        {% if not show_home and not landing_page %}
        <div class="profile" id="profile">
            <button class="profile-btn" id="profileBtn" aria-haspopup="true" aria-expanded="false"
                aria-controls="profileMenu" title="Profil">
                <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <circle cx="12" cy="8" r="4" />
                    <path d="M4 20c0-4 4-6 8-6s8 2 8 6" />
                </svg>
            </button>
            <div class="menu" id="profileMenu" role="menu" aria-label="Profil">
                <h4>Uživatel</h4>
                <form method="POST" action="{{ url_for('priorities.restart_priorities') }}">
                    <button class="item" type="submit" role="menuitem">
                        <svg viewBox="0 0 24 24" fill="none" style="width:18px;height:18px;" stroke="currentColor"
                            stroke-width="2">
                            <path d="M4 4v6h6M20 20v-6h-6M20 9a9 9 0 1 0-2.64 6.36L20 20" stroke-linecap="round"
                                stroke-linejoin="round" />
                        </svg>
                        Začít znovu
                    </button>
                </form>
                <div class="sep"></div>
                <form method="POST" action="/logout">
                    <button class="item" type="submit" role="menuitem">
                        <svg viewBox="0 0 24 24" fill="none" style="width:18px;height:18px;" stroke="currentColor"
                            stroke-width="2">
                            <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1 2 2h-4M10 17l5-5-5-5M15 12H3"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        Odhlásit
                    </button>
                </form>
            </div>
        </div>
        {% endif %}
        {% endblock %}
    </header>

    <div class="bg">
        <span class="blob r1"></span>
        <span class="blob r2"></span>
        <span class="blob y1"></span>
        <span class="blob y2"></span>
        <span class="blob y3"></span>
    </div>

    <div class="wrap">
        <div class="glass">
            <main id="app">
                {% block inner_header %}{% endblock %}
                {% block content %}{% endblock %}
            </main>
        </div>
    </div>

    <script>
        // Profile menu interactions
        (function () {
            const root = document.getElementById('profile');
            const btn = document.getElementById('profileBtn');
            const menu = document.getElementById('profileMenu');
            if (!root || !btn || !menu) return;

            let hideTimer = null;

            function openMenu() {
                menu.classList.add('open');
                btn.setAttribute('aria-expanded', 'true');
            }

            function closeMenu() {
                menu.classList.remove('open');
                btn.setAttribute('aria-expanded', 'false');
            }

            function scheduleClose() {
                clearTimeout(hideTimer);
                hideTimer = setTimeout(closeMenu, 160);
            }

            function cancelClose() {
                clearTimeout(hideTimer);
            }

            const isTouch = window.matchMedia && window.matchMedia('(hover: none)').matches;

            if (!isTouch) {
                root.addEventListener('mouseenter', () => {
                    cancelClose();
                    openMenu();
                });
                root.addEventListener('mouseleave', scheduleClose);
                menu.addEventListener('mouseenter', cancelClose);
                menu.addEventListener('mouseleave', scheduleClose);

                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        cancelClose();
                        closeMenu();
                    }
                });
            } else {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const willOpen = !menu.classList.contains('open');
                    menu.classList.toggle('open', willOpen);
                    btn.setAttribute('aria-expanded', String(willOpen));
                });

                document.addEventListener('click', (e) => {
                    if (!root.contains(e.target)) {
                        menu.classList.remove('open');
                        btn.setAttribute('aria-expanded', 'false');
                    }
                });
            }
        })();

        // Site header height CSS var (for vertical centering without overlap)
        (function () {
            const siteHdr = document.querySelector('.site-header');
            if (!siteHdr) return;

            function setSiteHdrVar() {
                const h = Math.round(siteHdr.getBoundingClientRect().height || 0);
                document.documentElement.style.setProperty('--site-h', h + 'px');
            }

            setSiteHdrVar();
            addEventListener('resize', setSiteHdrVar, { passive: true });
            addEventListener('load', setSiteHdrVar, { once: true });

            if (document.fonts && document.fonts.ready && typeof document.fonts.ready.then === 'function') {
                document.fonts.ready.then(setSiteHdrVar).catch(() => { });
            }

            if (typeof ResizeObserver === 'function') {
                try {
                    new ResizeObserver(() => setSiteHdrVar()).observe(siteHdr);
                } catch (_) { }
            }
        })();
    </script>
    {% block scripts %}{% endblock %}
    {% block scripts_extra %}{% endblock %}
</body>

</html>